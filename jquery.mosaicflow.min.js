/*! jQuery Mosaic Flow v0.2.5 by Artem Sapegin - http://sapegin.github.io/jquery.mosaicflow/ - Licensed MIT */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){"use strict";function i(t,i){this.container=t,this.options=i,this.container.trigger("start"),this.init(),this.container.trigger("ready")}function n(t){function i(t,i){return i.toUpper()}var n={},e=t.data();for(var s in e)n[s.replace(/-(\w)/g,i)]=e[s];return n}var e=0;t.fn.mosaicflow=function(e){var s=Array.prototype.slice.call(arguments,0);return this.each(function(){var o=t(this),r=o.data("mosaicflow");r?"string"==typeof e&&r[e](s[1]):(e=t.extend({},t.fn.mosaicflow.defaults,e,n(o)),r=new i(o,e),o.data("mosaicflow",r))})},t.fn.mosaicflow.defaults={itemSelector:"> *",columnClass:"mosaicflow__column",minItemWidth:240,threshold:40,levelBottom:!0},i.prototype={init:function(){this.__uid=e++,this.__uidItemCounter=0,this.items=this.container.find(this.options.itemSelector),this.columns=t([]),this.tempContainer=t("<div>").css({visibility:"hidden",width:"100%"}),this.workOnTemp=!1,this.autoCalculation="auto"===this.options.itemHeightCalculation,this.container.append(this.tempContainer);var i=this;this.items.each(function(){var n=t(this),e=n.attr("id");e||(e=i.generateUniqueId(),n.attr("id",e))}),this.container.css("visibility","hidden"),this.autoCalculation?t(window).load(t.proxy(this.refill,this)):this.refill(),t(window).resize(t.proxy(this.refill,this))},refill:function(){this.container.trigger("fill"),this.numberOfColumns=Math.floor(this.container.width()/this.options.minItemWidth),this.numberOfColumns<1&&(this.numberOfColumns=1);var t=this.ensureColumns();t&&(this.fillColumns(),this.columns.filter(":hidden").remove()),this.container.css("visibility","visible"),this.container.trigger("filled")},ensureColumns:function(){var i=this.columns.length,n=this.numberOfColumns;if(this.workingContainer=0===i?this.tempContainer:this.container,n>i)for(var e=n-i,s=0;e>s;s++){var o=t("<div>",{"class":this.options.columnClass});this.workingContainer.append(o)}else if(i>n){for(var r=i;r>=n;)this.columns.eq(r).hide(),r--}return n!==i?(this.columns=this.workingContainer.find("."+this.options.columnClass),this.columns.css("width",100/n+"%"),!0):!1},fillColumns:function(){for(var t=this.numberOfColumns,i=this.items.length,n=0;t>n;n++)for(var e=this.columns.eq(n),s=n;i>s;s+=t){var o=this.items.eq(s);e.append(o)}this.levelBottomEdge(),this.workingContainer===this.tempContainer&&this.container.append(this.tempContainer.children()),this.container.trigger("mosaicflow-layout")},columnsHeights:function(){var i=this.container.find("."+this.options.columnClass).map(function(i,n){return t(n).height()});return i},levelBottomEdge:function(){if(this.levelBottom)for(;;){var i=this.columnsHeights(),n=t.inArray(Math.min.apply(null,i),i),e=t.inArray(Math.max.apply(null,i),i);if(n===e)return;var s=this.columns.eq(e).children().last(),o=s.height(),r=i[n],a=i[e],h=r+o;if(h>=a)return;if(a-h<this.options.threshold)return;this.columns.eq(n).append(s)}},add:function(i){this.container.trigger("add");var n=this.columnsHeights(),e=t.inArray(Math.min.apply(null,n),n);i.attr("id")||i.attr("id",this.generateUniqueId());var s=this.items.toArray();s.push(i),this.items=t(s),this.columns.eq(e).append(i),this.levelBottomEdge(),this.container.trigger("mosaicflow-layout"),this.container.trigger("added")},remove:function(t){this.container.trigger("remove");t.parents("."+this.options.columnClass);t.detach(),this.items=this.items.not(t),this.levelBottomEdge(),this.container.trigger("mosaicflow-layout"),this.container.trigger("removed")},empty:function(){var i=this.numberOfColumns;this.items=t([]);for(var n=0;i>n;n++){var e=this.columns.eq(n);e.empty()}this.container.trigger("mosaicflow-layout")},generateUniqueId:function(){return this.__uidItemCounter++,"mosaic-"+this.__uid+"-itemid-"+this.__uidItemCounter}},t(function(){t(".mosaicflow").mosaicflow()})});
